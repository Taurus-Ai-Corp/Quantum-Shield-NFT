# Production Deployment Checklist

Complete checklist for deploying Quantum-Shield-NFT to production on Vercel.

## Pre-Deployment Verification

### 1. Code Quality ✅

- [x] All tests passing (`npm run test:all`)
  - Backend tests: `npm test`
  - Frontend tests: `npm run test:web`
  - E2E tests: `npm run test:e2e`
  - Integration tests: `npm run test:integration`

- [x] TypeScript compilation successful (`npm run typecheck`)

- [x] Linting clean (`npm run lint`)

- [x] Formatting consistent (`npm run format:check`)

- [x] No security vulnerabilities (`npm audit`)

- [x] Dependencies up to date (Dependabot configured)

### 2. Configuration Files ✅

- [x] `web/vercel.json` - Vercel deployment config
- [x] `web/.env.example` - Environment variable template
- [x] `codecov.yml` - Code coverage config
- [x] `.github/workflows/test.yml` - CI/CD pipeline
- [x] `.github/workflows/deploy.yml` - Production deploy workflow
- [x] `docs/DEPLOYMENT.md` - Deployment documentation

### 3. Documentation ✅

- [x] README.md complete and accurate
- [x] API documentation (if applicable)
- [x] Environment variable guide (`web/.env.example`)
- [x] Deployment guide (`docs/DEPLOYMENT.md`)
- [x] Codecov setup (`docs/CODECOV.md`)

### 4. Testing Coverage ✅

- [x] Backend coverage ≥80%
- [x] Frontend coverage ≥75%
- [x] E2E tests cover critical paths (31 tests)
- [x] Integration tests defined (16 tests, ready when API available)

## Deployment Steps

### Step 1: Verify Local Build

```bash
# 1. Clean install
rm -rf node_modules web/node_modules package-lock.json web/package-lock.json
npm install

# 2. Build frontend
cd web && npm run build

# 3. Verify build successful
ls -la .next/

# 4. Test production build locally
npm run start
# Visit http://localhost:3000 and verify functionality

# 5. Run all tests
cd .. && npm run test:all
```

**Expected:** All steps succeed, no errors.

### Step 2: Set Up Vercel Project

#### Option A: Vercel CLI

```bash
# 1. Install Vercel CLI globally
npm install -g vercel

# 2. Login to Vercel
vercel login

# 3. Link project (run from web/ directory)
cd web && vercel link

# Follow prompts:
# - Set up and deploy "~/path/to/web"? Yes
# - Which scope? Your Vercel account
# - Link to existing project? No (first time) / Yes (subsequent)
# - What's your project's name? quantum-shield-nft
# - In which directory is your code located? ./
```

#### Option B: Vercel Dashboard

1. Visit [vercel.com/new](https://vercel.com/new)
2. Import Git repository: `Taurus-Ai-Corp/Quantum-Shield-NFT`
3. Configure project:
   - **Framework Preset:** Next.js
   - **Root Directory:** `web`
   - **Build Command:** `npm run build`
   - **Output Directory:** `.next`
   - **Install Command:** `npm install`
   - **Node Version:** 20.x

### Step 3: Configure Environment Variables

Add these environment variables in Vercel dashboard (Settings → Environment Variables):

#### Production Environment

```bash
# Next.js Configuration
NEXT_PUBLIC_API_URL=https://api.quantum-shield-nft.com
NEXT_PUBLIC_HEDERA_NETWORK=mainnet

# NextAuth Configuration (generate secure random string)
NEXTAUTH_SECRET=<generate-with-openssl-rand-base64-32>
NEXTAUTH_URL=https://quantum-shield-nft.vercel.app

# Hedera Configuration (use mainnet credentials)
HEDERA_OPERATOR_ID=0.0.YOUR_MAINNET_ACCOUNT
HEDERA_OPERATOR_KEY=<your-mainnet-private-key>

# Feature Flags
NEXT_PUBLIC_ENABLE_ANALYTICS=true
NEXT_PUBLIC_ENABLE_DEBUG=false
```

#### Preview Environment

```bash
# Next.js Configuration
NEXT_PUBLIC_API_URL=https://api-preview.quantum-shield-nft.com
NEXT_PUBLIC_HEDERA_NETWORK=testnet

# NextAuth Configuration
NEXTAUTH_SECRET=<preview-secret>
NEXTAUTH_URL=<auto-generated-preview-url>

# Hedera Configuration (use testnet)
HEDERA_OPERATOR_ID=0.0.YOUR_TESTNET_ACCOUNT
HEDERA_OPERATOR_KEY=<your-testnet-private-key>

# Feature Flags
NEXT_PUBLIC_ENABLE_ANALYTICS=false
NEXT_PUBLIC_ENABLE_DEBUG=true
```

### Step 4: Deploy to Preview

```bash
# Deploy to preview environment
cd web && vercel

# Expected output:
# Deploying ~/path/to/web
# Inspecting... ✓
# Building... ✓
# Deploying... ✓
# Preview: https://quantum-shield-nft-preview-abc123.vercel.app
```

**Verify preview deployment:**
1. Visit preview URL
2. Test critical functionality:
   - Landing page loads
   - Navigation works
   - Wallet connection (testnet)
   - Shield creation form displays
3. Check browser console for errors
4. Test responsive design (mobile, tablet, desktop)

### Step 5: Deploy to Production

#### Option A: Vercel CLI

```bash
# Deploy to production
cd web && vercel --prod

# Confirm prompts:
# - Deploy to production? Yes

# Expected output:
# Production: https://quantum-shield-nft.vercel.app
```

#### Option B: GitHub Integration (Recommended)

1. Merge feature branch to `main`
2. GitHub Actions automatically triggers deployment
3. Vercel detects push to `main` and deploys to production
4. Monitor deployment in Vercel dashboard

**Automatic deployment workflow:**
```
Push to main → GitHub Actions runs tests
            → Tests pass
            → Vercel deploys to production
            → Production URL updated
```

### Step 6: Post-Deployment Verification

#### Health Checks

```bash
# 1. Check production URL loads
curl -I https://quantum-shield-nft.vercel.app
# Expected: HTTP/2 200

# 2. Verify API proxy works (if applicable)
curl https://quantum-shield-nft.vercel.app/api/health
# Expected: {"status":"healthy"}

# 3. Check security headers
curl -I https://quantum-shield-nft.vercel.app | grep -E "X-Frame-Options|X-Content-Type-Options|Strict-Transport-Security"
# Expected: All security headers present
```

#### Functionality Testing

- [ ] Landing page loads correctly
- [ ] All navigation links work
- [ ] HashConnect wallet integration functional
- [ ] Shield creation form displays
- [ ] Responsive design works on mobile
- [ ] No console errors
- [ ] Analytics tracking active (if enabled)

#### Performance Verification

Visit [PageSpeed Insights](https://pagespeed.web.dev/) and test production URL:

- Target Metrics:
  - LCP (Largest Contentful Paint): <2.5s
  - FID (First Input Delay): <100ms
  - CLS (Cumulative Layout Shift): <0.1
  - Performance Score: ≥90

### Step 7: Domain Configuration (Optional)

If using custom domain:

1. **Add domain in Vercel:**
   - Go to project Settings → Domains
   - Add custom domain (e.g., `shield.q-grid.ca`)
   - Follow DNS configuration instructions

2. **Update DNS records:**
   - Add CNAME record: `shield` → `cname.vercel-dns.com`
   - Or A record: `@` → Vercel IP address

3. **Update environment variables:**
   - Set `NEXTAUTH_URL` to custom domain
   - Update `NEXT_PUBLIC_API_URL` if API on custom domain

4. **Verify SSL certificate:**
   - Vercel automatically provisions SSL
   - Check HTTPS works: `https://shield.q-grid.ca`

### Step 8: Monitoring Setup

#### Vercel Analytics

1. Enable Vercel Analytics in dashboard
2. View real-time metrics:
   - Page views
   - Unique visitors
   - Response times
   - Error rates

#### Error Tracking (Optional)

Consider integrating:
- **Sentry:** Application error monitoring
- **LogRocket:** Session replay and debugging
- **PostHog:** Product analytics

#### Uptime Monitoring (Optional)

Use services like:
- **UptimeRobot:** Free uptime monitoring
- **Pingdom:** Advanced monitoring
- **Better Uptime:** Status page + monitoring

## Production Deployment Workflow

### Recommended Git Flow

```
feature/branch → develop → main → production
```

1. **Feature development:**
   - Create feature branch: `git checkout -b feature/my-feature`
   - Develop and test locally
   - Create PR to `develop` branch

2. **Staging deployment:**
   - Merge PR to `develop`
   - Vercel auto-deploys to preview environment
   - QA testing on preview URL

3. **Production release:**
   - Create PR from `develop` to `main`
   - Code review + approval
   - Merge to `main`
   - Vercel auto-deploys to production

### Rollback Procedure

If production deployment has issues:

#### Option A: Vercel Dashboard

1. Go to Deployments tab
2. Find last known good deployment
3. Click "Promote to Production"
4. Confirm rollback

#### Option B: Git Revert

```bash
# 1. Revert problematic commit
git revert <commit-hash>

# 2. Push to main
git push origin main

# 3. Vercel auto-deploys reverted version
```

## Production Checklist

Before going live:

### Security

- [ ] All secrets stored in Vercel environment variables (not in code)
- [ ] `.env` files in `.gitignore`
- [ ] Security headers configured in `vercel.json`
- [ ] CORS properly configured (no wildcards in production)
- [ ] Rate limiting enabled
- [ ] API authentication enforced
- [ ] No debug mode or console.logs in production

### Performance

- [ ] Images optimized (WebP/AVIF format)
- [ ] Code splitting configured
- [ ] Lazy loading for below-the-fold content
- [ ] CDN caching enabled
- [ ] Bundle size optimized (<300KB initial)
- [ ] Lighthouse score ≥90

### SEO

- [ ] Meta tags configured (title, description, OG tags)
- [ ] `robots.txt` allows indexing
- [ ] Sitemap generated
- [ ] Canonical URLs set
- [ ] Structured data (JSON-LD) added

### Analytics

- [ ] Google Analytics / PostHog configured
- [ ] Conversion tracking set up
- [ ] Error tracking active
- [ ] Performance monitoring enabled

### Legal & Compliance

- [ ] Privacy policy page
- [ ] Terms of service page
- [ ] Cookie consent banner (if EU traffic)
- [ ] GDPR compliance (if applicable)
- [ ] Accessibility standards (WCAG AA)

### Business

- [ ] Production domain configured (if custom domain)
- [ ] SSL certificate active
- [ ] Monitoring and alerting configured
- [ ] Backup plan documented
- [ ] Support contact information visible
- [ ] Status page created (optional)

## Post-Launch

### Week 1

- [ ] Monitor error rates daily
- [ ] Check performance metrics
- [ ] Review user feedback
- [ ] Fix critical bugs immediately
- [ ] Deploy hotfixes if needed

### Month 1

- [ ] Review analytics data
- [ ] Identify performance bottlenecks
- [ ] Plan optimization improvements
- [ ] Update documentation as needed
- [ ] Review security logs

### Ongoing

- [ ] Weekly dependency updates (Dependabot)
- [ ] Monthly security audits
- [ ] Quarterly performance reviews
- [ ] Regular backup verification
- [ ] User feedback collection and analysis

## Troubleshooting

### Deployment Fails

**Symptom:** Build fails in Vercel

**Solutions:**
1. Check Vercel build logs for error details
2. Verify all dependencies in `package.json`
3. Test build locally: `npm run build`
4. Check Node version matches Vercel (20.x)
5. Verify environment variables set correctly

### Environment Variables Not Loading

**Symptom:** App can't access `process.env.NEXT_PUBLIC_*`

**Solutions:**
1. Ensure env vars prefixed with `NEXT_PUBLIC_` for client-side
2. Redeploy after adding env vars (changes require redeploy)
3. Check env vars set for correct environment (production vs preview)
4. Verify no typos in variable names

### API Routes Return 404

**Symptom:** API proxy not working

**Solutions:**
1. Verify `vercel.json` rewrites configured correctly
2. Check API server is running and accessible
3. Test API endpoint directly
4. Review Vercel function logs

### Slow Performance

**Symptom:** Long load times, poor Lighthouse scores

**Solutions:**
1. Check bundle size: `npm run build && ls -lh .next/static/chunks/`
2. Enable Vercel Analytics to identify bottlenecks
3. Optimize images (use Next.js Image component)
4. Lazy load components: `const Component = dynamic(() => import('...'))`
5. Review network waterfall in browser DevTools

## Resources

- **Vercel Docs:** https://vercel.com/docs
- **Next.js Deployment:** https://nextjs.org/docs/deployment
- **Vercel CLI:** https://vercel.com/docs/cli
- **Environment Variables:** https://vercel.com/docs/concepts/projects/environment-variables
- **Custom Domains:** https://vercel.com/docs/concepts/projects/custom-domains

---

**Last Updated:** 2026-02-23
**Deployment Target:** Vercel (Frontend)
**Status:** ✅ Ready for production deployment
